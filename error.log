ERROR:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"text","id":"516220543884591286","quoteToken":"fCLK2wcAhEypL2Vl66DT4Ql0JmtT4cL8UoiXrmHxo8byKh3H4mq1E9DA504D8FB2z8BJHFy-UKDSA2ZHRb_hGu5eGdf-zlmzpXWykBYK8DvPILAxp7djYf3OJQINA5iZKYJQk67vcNU1gOofrqyjzQ","text":"trainer"},"webhookEventId":"01J2BJAPBW9TDV7Z9BNXS9FDEY","deliveryContext":{"isRedelivery":false},"timestamp":1720522725519,"source":{"type":"user","userId":"Ufd0387d671515580a8eb4d9bee633713"},"replyToken":"4f3f8761929c40819a2de810a5cb6c85","mode":"active"}]}
ERROR:root:user_id: 5, total_calories: None, target_calories: 1500
ERROR:app:Exception on /callback [POST]
Traceback (most recent call last):
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/flask/app.py", line 1473, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/flask/app.py", line 882, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/diary/FitHero/app.py", line 58, in callback
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/linebot/webhook.py", line 278, in handle
    self.__invoke_func(func, event, payload)
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/linebot/webhook.py", line 290, in __invoke_func
    func(event)
  File "/Users/chikamitsumai/b4_finetune/diary/FitHero/app.py", line 93, in handle_text_message
    [TextSendMessage(text="Something went wrong. Please try again.")]
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/diary/FitHero/trainer.py", line 149, in generate_trainer_image
    status = judge_trainer_status(user_id)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/diary/FitHero/trainer.py", line 128, in judge_trainer_status
    if total_calories < target_calories:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '<' not supported between instances of 'NoneType' and 'int'
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 19:58:45] "[35m[1mPOST /callback HTTP/1.1[0m" 500 -
ERROR:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"text","id":"516220562725929080","quoteToken":"yFvGCMz3cylI2Z8dwkSbY4qv9azzH38tE9q1E69-mwISEqyK-zQT-Fuge3hJFGnaLDClMVRMcVr6LfTEiahKVr5eZVHNDDT3gT_mJ54x3B5anQ0nvNPgykt70fUADD8-bJf4KvE-4aLBb-jlUvOH0g","text":"初回"},"webhookEventId":"01J2BJB1BXRQFJDEFKFSN3PDQE","deliveryContext":{"isRedelivery":false},"timestamp":1720522736841,"source":{"type":"user","userId":"Ufd0387d671515580a8eb4d9bee633713"},"replyToken":"b6ca1c78b67e4bfd9fe071eb9f9030ab","mode":"active"}]}
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 19:58:57] "POST /callback HTTP/1.1" 200 -
ERROR:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"text","id":"516220600575066458","quoteToken":"ZmfdLZWd1RkrieEvf69Yp77uSkzKuyx4cRoOj602AvXA7frGG39lvRsrYHmYLlg-j9e_bkkt-5PRyFNtbaGyUYzqcmMdqS9tZ1rgAHgEFJgA-mdzHHyiwvIVZrX9XbPrxrdsQc3n2rytFjevldy1tg","text":"hei"},"webhookEventId":"01J2BJBQMA12X0MXC262DY5NDF","deliveryContext":{"isRedelivery":false},"timestamp":1720522759309,"source":{"type":"user","userId":"Ufd0387d671515580a8eb4d9bee633713"},"replyToken":"59cbcaed294c4714872df3ef003d99b8","mode":"active"}]}
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 19:59:19] "POST /callback HTTP/1.1" 200 -
ERROR:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"text","id":"516220621446447128","quoteToken":"a1XJBcUEfm9MS0xKCR5qcHINqVxdxcfB5V9Hc42V-hsMhblUnpxXJ1w9HYPndGu6XGMPmENA_DS1v66gRaiDC2LpT3cVpr3YZKpS8Sj2GFv2gl6fnY0liFmHjradxgzyr25J_yphB8I57PubXoa8sw","text":"初回"},"webhookEventId":"01J2BJC3RMW94N5NFZ39D79AWY","deliveryContext":{"isRedelivery":false},"timestamp":1720522771796,"source":{"type":"user","userId":"Ufd0387d671515580a8eb4d9bee633713"},"replyToken":"82a826252f25436894baa7f9a6c8eb45","mode":"active"}]}
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 19:59:32] "POST /callback HTTP/1.1" 200 -
ERROR:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"text","id":"516220626680938802","quoteToken":"c-QRT8gv6xtDl1GuyOoJD2T5K06ma65RmHFBCB4-Vwt1RZgQiRYDmgmNAdNH1W8gS9vkGTefDfZUuZ7xITCOyYarTvg080luYnohdntt6nmy78vHEDSYA6UPsM9zxJwrTA8UfHOCiwuFlj-H-a4qMQ","text":"hei"},"webhookEventId":"01J2BJC6PZQBT5MSTK6N9EDX0K","deliveryContext":{"isRedelivery":false},"timestamp":1720522774805,"source":{"type":"user","userId":"Ufd0387d671515580a8eb4d9bee633713"},"replyToken":"f81a36ef1198426e95c77c29c1e2efae","mode":"active"}]}
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 19:59:35] "POST /callback HTTP/1.1" 200 -
ERROR:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"text","id":"516220992993886582","quoteToken":"kT8C9K6ToWpFEjMtqMSMkQ3FxiT5zNffp0uq9EHV9goAiUr0Ac-2MQ9DPRplzXl7TvbaR5qToJ11rrlJg0Lh3MiZfm0KRcDkghqImiyMPQggrijp4K5MEi_5gwowY-iAUuf0G5hnmPoFmzuQVs64Tw","text":"trainer"},"webhookEventId":"01J2BJJVZSHPDJ7TZQH7SYS6F4","deliveryContext":{"isRedelivery":false},"timestamp":1720522993149,"source":{"type":"user","userId":"Ufd0387d671515580a8eb4d9bee633713"},"replyToken":"04a05e4239fd41fcbb56249633f0bba1","mode":"active"}]}
ERROR:root:user_id: 5, total_calories: None, target_calories: 1500
ERROR:app:Exception on /callback [POST]
Traceback (most recent call last):
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/flask/app.py", line 1473, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/flask/app.py", line 882, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/flask/app.py", line 880, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/flask/app.py", line 865, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/diary/FitHero/app.py", line 58, in callback
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/linebot/webhook.py", line 278, in handle
    self.__invoke_func(func, event, payload)
  File "/Users/chikamitsumai/b4_finetune/venv/lib/python3.12/site-packages/linebot/webhook.py", line 290, in __invoke_func
    func(event)
  File "/Users/chikamitsumai/b4_finetune/diary/FitHero/app.py", line 93, in handle_text_message
    [TextSendMessage(text="Something went wrong. Please try again.")]
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/diary/FitHero/trainer.py", line 149, in generate_trainer_image
    handsomeness = 0
         ^^^^^^^^^^^^
  File "/Users/chikamitsumai/b4_finetune/diary/FitHero/trainer.py", line 128, in judge_trainer_status
    logging.error(f"user_id: {user_id}, total_calories: {total_calories}, target_calories: {target_calories}")
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: '<' not supported between instances of 'NoneType' and 'int'
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 20:03:13] "[35m[1mPOST /callback HTTP/1.1[0m" 500 -
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5002
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5002
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug: * Restarting with stat
WARNING:werkzeug: * Debugger is active!
INFO:werkzeug: * Debugger PIN: 120-970-701
INFO:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"text","id":"516221583116206105","quoteToken":"_EHniz_MgBnHYHwSU8N1snEdmx3SjYFzVCWlNNieaqEPu0uIVoFrRhMHl1mgfmWM_zviwiCj0jpTLujq2cUh33iGhdqIsyWYQ64RFslPk-924855ukRkbzWzzpu1HZyjTI4QPkJTVEy9FqJpeXA9VA","text":"trainer"},"webhookEventId":"01J2BJXKHVSGRG3E709Y4RV7FV","deliveryContext":{"isRedelivery":false},"timestamp":1720523345041,"source":{"type":"user","userId":"Ufd0387d671515580a8eb4d9bee633713"},"replyToken":"a62c1eef3db04c5c912aa30112f0f81e","mode":"active"}]}
ERROR:root:user_id: 5, total_calories: None, target_calories: 1500
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 20:09:05] "[35m[1mPOST /callback HTTP/1.1[0m" 500 -
INFO:werkzeug: * Detected change in '/Users/chikamitsumai/b4_finetune/diary/FitHero/trainer.py', reloading
INFO:werkzeug: * Restarting with stat
WARNING:werkzeug: * Debugger is active!
INFO:werkzeug: * Debugger PIN: 120-970-701
INFO:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"text","id":"516222118175441042","quoteToken":"4rATK2KytVJ_gVTyq5I-OUOJ8F2K0hRk1dbaTYD2N5SqJOt9aFd5iUSpltAKCKKQehUuYInFjIcZ5EX5lEBUzenvKchY4y3StDYtlzfjR9GG0iEUGP_MoGmXAWx5hu0K6rkuQb9qaKKd4QkuG3QdWg","text":"trainer"},"webhookEventId":"01J2BK7AZFV93TT6TQH0XH5MZK","deliveryContext":{"isRedelivery":false},"timestamp":1720523663860,"source":{"type":"user","userId":"Ufd0387d671515580a8eb4d9bee633713"},"replyToken":"0936cdf0caba44f0b817bab1e280c4fd","mode":"active"}]}
ERROR:root:user_id: 5, total_calories: 0, target_calories: 1500
ERROR:root:status: good
ERROR:root:user_id: 5, total_calories: 0, target_calories: 1500
ERROR:root:status: good
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 20:17:21] "POST /callback HTTP/1.1" 200 -
INFO:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"text","id":"516222703666725416","quoteToken":"M6ituB5HmBpftYyrpQhfiDj10QjoQYURdPxKI2mkWYkHdL04cI1JCFmCjK_xhiBKkoIRoihS0jsX8clpSwkVbGGSRSdKYPRzBKi3cQ1ztBmS5Y1WogU3sHHnH3ruKQiDTo1keCKAN4WBprnCxpm9yQ","text":"trainer"},"webhookEventId":"01J2BKHZDT9GTWY6844T5YBQJ8","deliveryContext":{"isRedelivery":false},"timestamp":1720524012926,"source":{"type":"user","userId":"U15b86ca70b38ee948977fb145f12033f"},"replyToken":"1fdb377fe0cf41f9bec6d34667f69fc8","mode":"active"}]}
ERROR:root:user_id: 4, total_calories: 0, target_calories: 2000
ERROR:root:status: good
ERROR:root:user_id: 4, total_calories: 0, target_calories: 2000
ERROR:root:status: good
INFO:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"text","id":"516222790388154369","quoteToken":"uU3marwIjfFokHSfc1cRSU-Tuc89hLhyjxlSAOY9-RC96-7ESBN8SDgDyKSQNWgXEuzILEEZb-atJgj1ZwbTTW5LDjvTpcHC5XhtNKC1qavmJdFpX__UnEmgHKwE_7ViNsYSglW0yTCCZbG7id4Shw","text":"trainer"},"webhookEventId":"01J2BKKHQVRFR7WPR8CM808YFG","deliveryContext":{"isRedelivery":false},"timestamp":1720524064469,"source":{"type":"user","userId":"U15b86ca70b38ee948977fb145f12033f"},"replyToken":"f980ba723f8b4a66afb599c306eb2f86","mode":"active"}]}
ERROR:root:user_id: 4, total_calories: 0, target_calories: 2000
ERROR:root:status: good
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 20:21:25] "POST /callback HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 20:21:37] "POST /callback HTTP/1.1" 200 -
INFO:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"image","id":"516223228339814532","quoteToken":"h6Usgt02sqvCoa7mD0FCqkX4qFZiMmwlMNSEwDjtkAkKVLeiYuAjkI-NrqLu4tczasysbWSLn4awA3fE6AzjNfqHTKyp02fZj-gOfzSsw85wCqROBVHtzc0zAZJqS68LwFvysrjwg1Nc2qGl3RJYVw","contentProvider":{"type":"line"}},"webhookEventId":"01J2BKVH4WB2AXH699QAXF8Z9Z","deliveryContext":{"isRedelivery":false},"timestamp":1720524325843,"source":{"type":"user","userId":"Ufd0387d671515580a8eb4d9bee633713"},"replyToken":"16eafcd317b24b96980edd408bfa7117","mode":"active"}]}
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 20:25:43] "POST /callback HTTP/1.1" 200 -
INFO:app:Request body: {"destination":"U577317a62dcc97625dc4aa72ae4659e9","events":[{"type":"message","message":{"type":"text","id":"516223292798140505","quoteToken":"ZgX2Ru4J9lafiyQJJAhuGIkgGEC8cjB93pdaMmXOiMCsKB8Rz1YuuQnPrFmSpeQ3dMfN4U1lDx9r6IoCwFsXHtF3fHDgjW-Iti3HmAl5S_RgY_fLTgQQpIqimXnVPo5JwE_f3XhRNFjANDs3zGyd6Q","text":"trainer"},"webhookEventId":"01J2BKWPB6HR9HZFJBCE7NK0MD","deliveryContext":{"isRedelivery":false},"timestamp":1720524364046,"source":{"type":"user","userId":"Ufd0387d671515580a8eb4d9bee633713"},"replyToken":"a3ca8e628d1c4c3ea3ed2f3d68446b33","mode":"active"}]}
ERROR:root:user_id: 5, total_calories: 350.0, target_calories: 1500
ERROR:root:status: good
ERROR:root:API呼び出しに失敗しました: sent 1011 (unexpected error) keepalive ping timeout; no close frame received
ERROR:root:s3_file_url is None, cannot save to SQL.
INFO:werkzeug:127.0.0.1 - - [09/Jul/2024 20:42:10] "POST /callback HTTP/1.1" 200 -
